{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EstimatedDocumentCountOperation = void 0;\nconst responses_1 = require(\"../cmap/wire_protocol/responses\");\nconst command_1 = require(\"./command\");\nconst operation_1 = require(\"./operation\");\n/** @internal */\nclass EstimatedDocumentCountOperation extends command_1.CommandOperation {\n  constructor(collection, options = {}) {\n    super(collection, options);\n    this.SERVER_COMMAND_RESPONSE_TYPE = responses_1.MongoDBResponse;\n    this.options = options;\n    this.collectionName = collection.collectionName;\n  }\n  get commandName() {\n    return 'count';\n  }\n  buildCommandDocument(_connection, _session) {\n    const cmd = {\n      count: this.collectionName\n    };\n    if (typeof this.options.maxTimeMS === 'number') {\n      cmd.maxTimeMS = this.options.maxTimeMS;\n    }\n    // we check for undefined specifically here to allow falsy values\n    // eslint-disable-next-line no-restricted-syntax\n    if (this.options.comment !== undefined) {\n      cmd.comment = this.options.comment;\n    }\n    return cmd;\n  }\n  handleOk(response) {\n    return response.getNumber('n') ?? 0;\n  }\n}\nexports.EstimatedDocumentCountOperation = EstimatedDocumentCountOperation;\n(0, operation_1.defineAspects)(EstimatedDocumentCountOperation, [operation_1.Aspect.READ_OPERATION, operation_1.Aspect.RETRYABLE, operation_1.Aspect.CURSOR_CREATING, operation_1.Aspect.SUPPORTS_RAW_DATA]);","map":{"version":3,"names":["responses_1","require","command_1","operation_1","EstimatedDocumentCountOperation","CommandOperation","constructor","collection","options","SERVER_COMMAND_RESPONSE_TYPE","MongoDBResponse","collectionName","commandName","buildCommandDocument","_connection","_session","cmd","count","maxTimeMS","comment","undefined","handleOk","response","getNumber","exports","defineAspects","Aspect","READ_OPERATION","RETRYABLE","CURSOR_CREATING","SUPPORTS_RAW_DATA"],"sources":["C:\\DEVC\\node_modules\\mongodb\\src\\operations\\estimated_document_count.ts"],"sourcesContent":["import { type Connection } from '..';\nimport type { Document } from '../bson';\nimport { MongoDBResponse } from '../cmap/wire_protocol/responses';\nimport type { Collection } from '../collection';\nimport type { ClientSession } from '../sessions';\nimport { CommandOperation, type CommandOperationOptions } from './command';\nimport { Aspect, defineAspects } from './operation';\n\n/** @public */\nexport interface EstimatedDocumentCountOptions extends CommandOperationOptions {\n  /**\n   * The maximum amount of time to allow the operation to run.\n   *\n   * This option is sent only if the caller explicitly provides a value. The default is to not send a value.\n   */\n  maxTimeMS?: number;\n}\n\n/** @internal */\nexport class EstimatedDocumentCountOperation extends CommandOperation<number> {\n  override SERVER_COMMAND_RESPONSE_TYPE = MongoDBResponse;\n  override options: EstimatedDocumentCountOptions;\n  collectionName: string;\n\n  constructor(collection: Collection, options: EstimatedDocumentCountOptions = {}) {\n    super(collection, options);\n    this.options = options;\n    this.collectionName = collection.collectionName;\n  }\n\n  override get commandName() {\n    return 'count' as const;\n  }\n\n  override buildCommandDocument(_connection: Connection, _session?: ClientSession): Document {\n    const cmd: Document = { count: this.collectionName };\n\n    if (typeof this.options.maxTimeMS === 'number') {\n      cmd.maxTimeMS = this.options.maxTimeMS;\n    }\n\n    // we check for undefined specifically here to allow falsy values\n    // eslint-disable-next-line no-restricted-syntax\n    if (this.options.comment !== undefined) {\n      cmd.comment = this.options.comment;\n    }\n\n    return cmd;\n  }\n\n  override handleOk(response: InstanceType<typeof this.SERVER_COMMAND_RESPONSE_TYPE>): number {\n    return response.getNumber('n') ?? 0;\n  }\n}\n\ndefineAspects(EstimatedDocumentCountOperation, [\n  Aspect.READ_OPERATION,\n  Aspect.RETRYABLE,\n  Aspect.CURSOR_CREATING,\n  Aspect.SUPPORTS_RAW_DATA\n]);\n"],"mappings":";;;;;;AAEA,MAAAA,WAAA,GAAAC,OAAA;AAGA,MAAAC,SAAA,GAAAD,OAAA;AACA,MAAAE,WAAA,GAAAF,OAAA;AAYA;AACA,MAAaG,+BAAgC,SAAQF,SAAA,CAAAG,gBAAwB;EAK3EC,YAAYC,UAAsB,EAAEC,OAAA,GAAyC,EAAE;IAC7E,KAAK,CAACD,UAAU,EAAEC,OAAO,CAAC;IALnB,KAAAC,4BAA4B,GAAGT,WAAA,CAAAU,eAAe;IAMrD,IAAI,CAACF,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACG,cAAc,GAAGJ,UAAU,CAACI,cAAc;EACjD;EAEA,IAAaC,WAAWA,CAAA;IACtB,OAAO,OAAgB;EACzB;EAESC,oBAAoBA,CAACC,WAAuB,EAAEC,QAAwB;IAC7E,MAAMC,GAAG,GAAa;MAAEC,KAAK,EAAE,IAAI,CAACN;IAAc,CAAE;IAEpD,IAAI,OAAO,IAAI,CAACH,OAAO,CAACU,SAAS,KAAK,QAAQ,EAAE;MAC9CF,GAAG,CAACE,SAAS,GAAG,IAAI,CAACV,OAAO,CAACU,SAAS;IACxC;IAEA;IACA;IACA,IAAI,IAAI,CAACV,OAAO,CAACW,OAAO,KAAKC,SAAS,EAAE;MACtCJ,GAAG,CAACG,OAAO,GAAG,IAAI,CAACX,OAAO,CAACW,OAAO;IACpC;IAEA,OAAOH,GAAG;EACZ;EAESK,QAAQA,CAACC,QAAgE;IAChF,OAAOA,QAAQ,CAACC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC;EACrC;;AAjCFC,OAAA,CAAApB,+BAAA,GAAAA,+BAAA;AAoCA,IAAAD,WAAA,CAAAsB,aAAa,EAACrB,+BAA+B,EAAE,CAC7CD,WAAA,CAAAuB,MAAM,CAACC,cAAc,EACrBxB,WAAA,CAAAuB,MAAM,CAACE,SAAS,EAChBzB,WAAA,CAAAuB,MAAM,CAACG,eAAe,EACtB1B,WAAA,CAAAuB,MAAM,CAACI,iBAAiB,CACzB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}