{"ast":null,"code":"'use strict';\n\nconst ArrayMethods = require('../../array/methods');\nconst Document = require('../../../document');\nconst getDiscriminatorByValue = require('../../../helpers/discriminator/getDiscriminatorByValue');\nconst internalToObjectOptions = require('../../../options').internalToObjectOptions;\nconst utils = require('../../../utils');\nconst isBsonType = require('../../../helpers/isBsonType');\nconst arrayParentSymbol = require('../../../helpers/symbols').arrayParentSymbol;\nconst arrayPathSymbol = require('../../../helpers/symbols').arrayPathSymbol;\nconst arraySchemaSymbol = require('../../../helpers/symbols').arraySchemaSymbol;\nconst documentArrayParent = require('../../../helpers/symbols').documentArrayParent;\nconst _baseToString = Array.prototype.toString;\nconst methods = {\n  /*!\n   * ignore\n   */\n\n  toBSON() {\n    return this.toObject(internalToObjectOptions);\n  },\n  toString() {\n    return _baseToString.call(this.__array.map(subdoc => {\n      if (subdoc?.$__ != null) {\n        return subdoc.toString();\n      }\n      return subdoc;\n    }));\n  },\n  /*!\n   * ignore\n   */\n\n  getArrayParent() {\n    return this[arrayParentSymbol];\n  },\n  /*!\n   * ignore\n   */\n  $schemaType() {\n    return this[arraySchemaSymbol];\n  },\n  /**\n   * Overrides MongooseArray#cast\n   *\n   * @method _cast\n   * @api private\n   * @memberOf MongooseDocumentArray\n   */\n\n  _cast(value, index, options) {\n    if (this[arraySchemaSymbol] == null) {\n      return value;\n    }\n    let Constructor = this[arraySchemaSymbol].Constructor;\n    const isInstance = Constructor.$isMongooseDocumentArray ? utils.isMongooseDocumentArray(value) : value instanceof Constructor;\n    if (isInstance ||\n    // Hack re: #5001, see #5005\n    value?.constructor?.baseCasterConstructor === Constructor) {\n      if (!(value[documentArrayParent] && value.__parentArray)) {\n        // value may have been created using array.create()\n        value[documentArrayParent] = this[arrayParentSymbol];\n        value.__parentArray = this;\n      }\n      value.$setIndex(index);\n      return value;\n    }\n    if (value == null) {\n      return null;\n    }\n\n    // handle cast('string') or cast(ObjectId) etc.\n    // only objects are permitted so we can safely assume that\n    // non-objects are to be interpreted as _id\n    if (Buffer.isBuffer(value) || isBsonType(value, 'ObjectId') || !utils.isObject(value)) {\n      value = {\n        _id: value\n      };\n    }\n    if (value && Constructor.discriminators && Constructor.schema && Constructor.schema.options && Constructor.schema.options.discriminatorKey) {\n      if (typeof value[Constructor.schema.options.discriminatorKey] === 'string' && Constructor.discriminators[value[Constructor.schema.options.discriminatorKey]]) {\n        Constructor = Constructor.discriminators[value[Constructor.schema.options.discriminatorKey]];\n      } else {\n        const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, value[Constructor.schema.options.discriminatorKey]);\n        if (constructorByValue) {\n          Constructor = constructorByValue;\n        }\n      }\n    }\n    if (Constructor.$isMongooseDocumentArray) {\n      return Constructor.cast(value, this, undefined, undefined, index);\n    }\n    const ret = new Constructor(value, this, options, undefined, index);\n    ret.isNew = true;\n    return ret;\n  },\n  /**\n   * Searches array items for the first document with a matching _id.\n   *\n   * #### Example:\n   *\n   *     const embeddedDoc = m.array.id(some_id);\n   *\n   * @return {EmbeddedDocument|null} the subdocument or null if not found.\n   * @param {ObjectId|String|Number|Buffer} id\n   * @method id\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  id(id) {\n    if (id == null) {\n      return null;\n    }\n    const schemaType = this[arraySchemaSymbol];\n    let idSchemaType = null;\n    if (schemaType?.schema) {\n      idSchemaType = schemaType.schema.path('_id');\n    } else if (schemaType?.casterConstructor?.schema) {\n      idSchemaType = schemaType.casterConstructor.schema.path('_id');\n    }\n    let castedId = null;\n    if (idSchemaType) {\n      try {\n        castedId = idSchemaType.cast(id);\n      } catch {\n        // ignore error\n      }\n    }\n    let _id;\n    for (const val of this) {\n      if (!val) {\n        continue;\n      }\n      _id = val.get('_id');\n      if (_id == null) {\n        continue;\n      } else if (_id instanceof Document) {\n        _id = _id.get('_id');\n        if (castedId != null && utils.deepEqual(castedId, _id)) {\n          return val;\n        } else if (castedId == null && (id == _id || utils.deepEqual(id, _id))) {\n          // Backwards compat: compare user-specified param to _id using loose equality\n          return val;\n        }\n      } else if (castedId != null && utils.deepEqual(castedId, _id)) {\n        return val;\n      } else if (castedId == null && (_id == id || utils.deepEqual(id, _id))) {\n        // Backwards compat: compare user-specified param to _id using loose equality\n        return val;\n      }\n    }\n    return null;\n  },\n  /**\n   * Returns a native js Array of plain js objects\n   *\n   * #### Note:\n   *\n   * _Each sub-document is converted to a plain object by calling its `#toObject` method._\n   *\n   * @param {Object} [options] optional options to pass to each documents `toObject` method call during conversion\n   * @return {Array}\n   * @method toObject\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  toObject(options) {\n    // `[].concat` coerces the return value into a vanilla JS array, rather\n    // than a Mongoose array.\n    return [].concat(this.map(function (doc) {\n      if (doc == null) {\n        return null;\n      }\n      if (typeof doc.toObject !== 'function') {\n        return doc;\n      }\n      return doc.toObject(options);\n    }));\n  },\n  $toObject() {\n    return this.constructor.prototype.toObject.apply(this, arguments);\n  },\n  /**\n   * Wraps [`Array#push`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/push) with proper change tracking.\n   *\n   * @param {...Object} [args]\n   * @api public\n   * @method push\n   * @memberOf MongooseDocumentArray\n   */\n\n  push() {\n    const ret = ArrayMethods.push.apply(this, arguments);\n    _updateParentPopulated(this);\n    return ret;\n  },\n  /**\n   * Pulls items from the array atomically.\n   *\n   * @param {...Object} [args]\n   * @api public\n   * @method pull\n   * @memberOf MongooseDocumentArray\n   */\n\n  pull() {\n    const ret = ArrayMethods.pull.apply(this, arguments);\n    _updateParentPopulated(this);\n    return ret;\n  },\n  /**\n   * Wraps [`Array#shift`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/unshift) with proper change tracking.\n   * @api private\n   */\n\n  shift() {\n    const ret = ArrayMethods.shift.apply(this, arguments);\n    _updateParentPopulated(this);\n    return ret;\n  },\n  /**\n   * Wraps [`Array#splice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice) with proper change tracking and casting.\n   * @api private\n   */\n\n  splice() {\n    const ret = ArrayMethods.splice.apply(this, arguments);\n    _updateParentPopulated(this);\n    return ret;\n  },\n  /**\n   * Helper for console.log\n   *\n   * @method inspect\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  inspect() {\n    return this.toObject();\n  },\n  /**\n   * Creates a subdocument casted to this schema.\n   *\n   * This is the same subdocument constructor used for casting.\n   *\n   * @param {Object} obj the value to cast to this arrays SubDocument schema\n   * @method create\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  create(obj) {\n    let Constructor = this[arraySchemaSymbol].Constructor;\n    if (obj && Constructor.discriminators && Constructor.schema && Constructor.schema.options && Constructor.schema.options.discriminatorKey) {\n      if (typeof obj[Constructor.schema.options.discriminatorKey] === 'string' && Constructor.discriminators[obj[Constructor.schema.options.discriminatorKey]]) {\n        Constructor = Constructor.discriminators[obj[Constructor.schema.options.discriminatorKey]];\n      } else {\n        const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, obj[Constructor.schema.options.discriminatorKey]);\n        if (constructorByValue) {\n          Constructor = constructorByValue;\n        }\n      }\n    }\n    return new Constructor(obj, this);\n  },\n  /*!\n   * ignore\n   */\n\n  notify(event) {\n    const _this = this;\n    return function notify(val, _arr) {\n      _arr = _arr || _this;\n      let i = _arr.length;\n      while (i--) {\n        if (_arr[i] == null) {\n          continue;\n        }\n        switch (event) {\n          // only swap for save event for now, we may change this to all event types later\n          case 'save':\n            val = _this[i];\n            break;\n          default:\n            // NO-OP\n            break;\n        }\n        if (utils.isMongooseArray(_arr[i])) {\n          notify(val, _arr[i]);\n        } else if (_arr[i]) {\n          _arr[i].emit(event, val);\n        }\n      }\n    };\n  },\n  set(i, val, skipModified) {\n    const arr = this.__array;\n    if (skipModified) {\n      arr[i] = val;\n      return this;\n    }\n    const value = methods._cast.call(this, val, i);\n    methods._markModified.call(this, i);\n    arr[i] = value;\n    return this;\n  },\n  _markModified(elem, embeddedPath) {\n    const parent = this[arrayParentSymbol];\n    let dirtyPath;\n    if (parent) {\n      dirtyPath = this[arrayPathSymbol];\n      if (arguments.length) {\n        if (embeddedPath != null) {\n          // an embedded doc bubbled up the change\n          const index = elem.__index;\n          dirtyPath = dirtyPath + '.' + index + '.' + embeddedPath;\n        } else {\n          // directly set an index\n          dirtyPath = dirtyPath + '.' + elem;\n        }\n      }\n      if (dirtyPath != null && dirtyPath.endsWith('.$')) {\n        return this;\n      }\n      parent.markModified(dirtyPath, arguments.length !== 0 ? elem : parent);\n    }\n    return this;\n  }\n};\nmodule.exports = methods;\n\n/**\n * If this is a document array, each element may contain single\n * populated paths, so we need to modify the top-level document's\n * populated cache. See gh-8247, gh-8265.\n * @param {Array} arr\n * @api private\n */\n\nfunction _updateParentPopulated(arr) {\n  const parent = arr[arrayParentSymbol];\n  if (!parent || parent.$__.populated == null) return;\n  const populatedPaths = Object.keys(parent.$__.populated).filter(p => p.startsWith(arr[arrayPathSymbol] + '.'));\n  for (const path of populatedPaths) {\n    const remnant = path.slice((arr[arrayPathSymbol] + '.').length);\n    if (!Array.isArray(parent.$__.populated[path].value)) {\n      continue;\n    }\n    parent.$__.populated[path].value = arr.map(val => val.$populated(remnant));\n  }\n}","map":{"version":3,"names":["ArrayMethods","require","Document","getDiscriminatorByValue","internalToObjectOptions","utils","isBsonType","arrayParentSymbol","arrayPathSymbol","arraySchemaSymbol","documentArrayParent","_baseToString","Array","prototype","toString","methods","toBSON","toObject","call","__array","map","subdoc","$__","getArrayParent","$schemaType","_cast","value","index","options","Constructor","isInstance","$isMongooseDocumentArray","isMongooseDocumentArray","constructor","baseCasterConstructor","__parentArray","$setIndex","Buffer","isBuffer","isObject","_id","discriminators","schema","discriminatorKey","constructorByValue","cast","undefined","ret","isNew","id","schemaType","idSchemaType","path","casterConstructor","castedId","val","get","deepEqual","concat","doc","$toObject","apply","arguments","push","_updateParentPopulated","pull","shift","splice","inspect","create","obj","notify","event","_this","_arr","i","length","isMongooseArray","emit","set","skipModified","arr","_markModified","elem","embeddedPath","parent","dirtyPath","__index","endsWith","markModified","module","exports","populated","populatedPaths","Object","keys","filter","p","startsWith","remnant","slice","isArray","$populated"],"sources":["C:/DEVC/node_modules/mongoose/lib/types/documentArray/methods/index.js"],"sourcesContent":["'use strict';\n\nconst ArrayMethods = require('../../array/methods');\nconst Document = require('../../../document');\nconst getDiscriminatorByValue = require('../../../helpers/discriminator/getDiscriminatorByValue');\nconst internalToObjectOptions = require('../../../options').internalToObjectOptions;\nconst utils = require('../../../utils');\nconst isBsonType = require('../../../helpers/isBsonType');\n\nconst arrayParentSymbol = require('../../../helpers/symbols').arrayParentSymbol;\nconst arrayPathSymbol = require('../../../helpers/symbols').arrayPathSymbol;\nconst arraySchemaSymbol = require('../../../helpers/symbols').arraySchemaSymbol;\nconst documentArrayParent = require('../../../helpers/symbols').documentArrayParent;\n\nconst _baseToString = Array.prototype.toString;\n\nconst methods = {\n  /*!\n   * ignore\n   */\n\n  toBSON() {\n    return this.toObject(internalToObjectOptions);\n  },\n\n  toString() {\n    return _baseToString.call(this.__array.map(subdoc => {\n      if (subdoc?.$__ != null) {\n        return subdoc.toString();\n      }\n      return subdoc;\n    }));\n  },\n\n  /*!\n   * ignore\n   */\n\n  getArrayParent() {\n    return this[arrayParentSymbol];\n  },\n\n  /*!\n   * ignore\n   */\n  $schemaType() {\n    return this[arraySchemaSymbol];\n  },\n\n  /**\n   * Overrides MongooseArray#cast\n   *\n   * @method _cast\n   * @api private\n   * @memberOf MongooseDocumentArray\n   */\n\n  _cast(value, index, options) {\n    if (this[arraySchemaSymbol] == null) {\n      return value;\n    }\n    let Constructor = this[arraySchemaSymbol].Constructor;\n    const isInstance = Constructor.$isMongooseDocumentArray ?\n      utils.isMongooseDocumentArray(value) :\n      value instanceof Constructor;\n    if (isInstance ||\n        // Hack re: #5001, see #5005\n        value?.constructor?.baseCasterConstructor === Constructor) {\n      if (!(value[documentArrayParent] && value.__parentArray)) {\n        // value may have been created using array.create()\n        value[documentArrayParent] = this[arrayParentSymbol];\n        value.__parentArray = this;\n      }\n      value.$setIndex(index);\n      return value;\n    }\n\n    if (value == null) {\n      return null;\n    }\n\n    // handle cast('string') or cast(ObjectId) etc.\n    // only objects are permitted so we can safely assume that\n    // non-objects are to be interpreted as _id\n    if (Buffer.isBuffer(value) ||\n        isBsonType(value, 'ObjectId') || !utils.isObject(value)) {\n      value = { _id: value };\n    }\n\n    if (value &&\n        Constructor.discriminators &&\n        Constructor.schema &&\n        Constructor.schema.options &&\n        Constructor.schema.options.discriminatorKey) {\n      if (typeof value[Constructor.schema.options.discriminatorKey] === 'string' &&\n          Constructor.discriminators[value[Constructor.schema.options.discriminatorKey]]) {\n        Constructor = Constructor.discriminators[value[Constructor.schema.options.discriminatorKey]];\n      } else {\n        const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, value[Constructor.schema.options.discriminatorKey]);\n        if (constructorByValue) {\n          Constructor = constructorByValue;\n        }\n      }\n    }\n\n    if (Constructor.$isMongooseDocumentArray) {\n      return Constructor.cast(value, this, undefined, undefined, index);\n    }\n    const ret = new Constructor(value, this, options, undefined, index);\n    ret.isNew = true;\n    return ret;\n  },\n\n  /**\n   * Searches array items for the first document with a matching _id.\n   *\n   * #### Example:\n   *\n   *     const embeddedDoc = m.array.id(some_id);\n   *\n   * @return {EmbeddedDocument|null} the subdocument or null if not found.\n   * @param {ObjectId|String|Number|Buffer} id\n   * @method id\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  id(id) {\n    if (id == null) {\n      return null;\n    }\n\n    const schemaType = this[arraySchemaSymbol];\n    let idSchemaType = null;\n\n    if (schemaType?.schema) {\n      idSchemaType = schemaType.schema.path('_id');\n    } else if (schemaType?.casterConstructor?.schema) {\n      idSchemaType = schemaType.casterConstructor.schema.path('_id');\n    }\n\n    let castedId = null;\n    if (idSchemaType) {\n      try {\n        castedId = idSchemaType.cast(id);\n      } catch {\n        // ignore error\n      }\n    }\n\n    let _id;\n\n    for (const val of this) {\n      if (!val) {\n        continue;\n      }\n\n      _id = val.get('_id');\n\n      if (_id == null) {\n        continue;\n      } else if (_id instanceof Document) {\n        _id = _id.get('_id');\n        if (castedId != null && utils.deepEqual(castedId, _id)) {\n          return val;\n        } else if (castedId == null && (id == _id || utils.deepEqual(id, _id))) {\n          // Backwards compat: compare user-specified param to _id using loose equality\n          return val;\n        }\n      } else if (castedId != null && utils.deepEqual(castedId, _id)) {\n        return val;\n      } else if (castedId == null && (_id == id || utils.deepEqual(id, _id))) {\n        // Backwards compat: compare user-specified param to _id using loose equality\n        return val;\n      }\n    }\n\n    return null;\n  },\n\n  /**\n   * Returns a native js Array of plain js objects\n   *\n   * #### Note:\n   *\n   * _Each sub-document is converted to a plain object by calling its `#toObject` method._\n   *\n   * @param {Object} [options] optional options to pass to each documents `toObject` method call during conversion\n   * @return {Array}\n   * @method toObject\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  toObject(options) {\n    // `[].concat` coerces the return value into a vanilla JS array, rather\n    // than a Mongoose array.\n    return [].concat(this.map(function(doc) {\n      if (doc == null) {\n        return null;\n      }\n      if (typeof doc.toObject !== 'function') {\n        return doc;\n      }\n      return doc.toObject(options);\n    }));\n  },\n\n  $toObject() {\n    return this.constructor.prototype.toObject.apply(this, arguments);\n  },\n\n  /**\n   * Wraps [`Array#push`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/push) with proper change tracking.\n   *\n   * @param {...Object} [args]\n   * @api public\n   * @method push\n   * @memberOf MongooseDocumentArray\n   */\n\n  push() {\n    const ret = ArrayMethods.push.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /**\n   * Pulls items from the array atomically.\n   *\n   * @param {...Object} [args]\n   * @api public\n   * @method pull\n   * @memberOf MongooseDocumentArray\n   */\n\n  pull() {\n    const ret = ArrayMethods.pull.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /**\n   * Wraps [`Array#shift`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/unshift) with proper change tracking.\n   * @api private\n   */\n\n  shift() {\n    const ret = ArrayMethods.shift.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /**\n   * Wraps [`Array#splice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice) with proper change tracking and casting.\n   * @api private\n   */\n\n  splice() {\n    const ret = ArrayMethods.splice.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /**\n   * Helper for console.log\n   *\n   * @method inspect\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  inspect() {\n    return this.toObject();\n  },\n\n  /**\n   * Creates a subdocument casted to this schema.\n   *\n   * This is the same subdocument constructor used for casting.\n   *\n   * @param {Object} obj the value to cast to this arrays SubDocument schema\n   * @method create\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  create(obj) {\n    let Constructor = this[arraySchemaSymbol].Constructor;\n    if (obj &&\n        Constructor.discriminators &&\n        Constructor.schema &&\n        Constructor.schema.options &&\n        Constructor.schema.options.discriminatorKey) {\n      if (typeof obj[Constructor.schema.options.discriminatorKey] === 'string' &&\n          Constructor.discriminators[obj[Constructor.schema.options.discriminatorKey]]) {\n        Constructor = Constructor.discriminators[obj[Constructor.schema.options.discriminatorKey]];\n      } else {\n        const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, obj[Constructor.schema.options.discriminatorKey]);\n        if (constructorByValue) {\n          Constructor = constructorByValue;\n        }\n      }\n    }\n\n    return new Constructor(obj, this);\n  },\n\n  /*!\n   * ignore\n   */\n\n  notify(event) {\n    const _this = this;\n    return function notify(val, _arr) {\n      _arr = _arr || _this;\n      let i = _arr.length;\n      while (i--) {\n        if (_arr[i] == null) {\n          continue;\n        }\n        switch (event) {\n          // only swap for save event for now, we may change this to all event types later\n          case 'save':\n            val = _this[i];\n            break;\n          default:\n            // NO-OP\n            break;\n        }\n\n        if (utils.isMongooseArray(_arr[i])) {\n          notify(val, _arr[i]);\n        } else if (_arr[i]) {\n          _arr[i].emit(event, val);\n        }\n      }\n    };\n  },\n\n  set(i, val, skipModified) {\n    const arr = this.__array;\n    if (skipModified) {\n      arr[i] = val;\n      return this;\n    }\n    const value = methods._cast.call(this, val, i);\n    methods._markModified.call(this, i);\n    arr[i] = value;\n    return this;\n  },\n\n  _markModified(elem, embeddedPath) {\n    const parent = this[arrayParentSymbol];\n    let dirtyPath;\n\n    if (parent) {\n      dirtyPath = this[arrayPathSymbol];\n\n      if (arguments.length) {\n        if (embeddedPath != null) {\n          // an embedded doc bubbled up the change\n          const index = elem.__index;\n          dirtyPath = dirtyPath + '.' + index + '.' + embeddedPath;\n        } else {\n          // directly set an index\n          dirtyPath = dirtyPath + '.' + elem;\n        }\n      }\n\n      if (dirtyPath != null && dirtyPath.endsWith('.$')) {\n        return this;\n      }\n\n      parent.markModified(dirtyPath, arguments.length !== 0 ? elem : parent);\n    }\n\n    return this;\n  }\n};\n\nmodule.exports = methods;\n\n/**\n * If this is a document array, each element may contain single\n * populated paths, so we need to modify the top-level document's\n * populated cache. See gh-8247, gh-8265.\n * @param {Array} arr\n * @api private\n */\n\nfunction _updateParentPopulated(arr) {\n  const parent = arr[arrayParentSymbol];\n  if (!parent || parent.$__.populated == null) return;\n\n  const populatedPaths = Object.keys(parent.$__.populated).\n    filter(p => p.startsWith(arr[arrayPathSymbol] + '.'));\n\n  for (const path of populatedPaths) {\n    const remnant = path.slice((arr[arrayPathSymbol] + '.').length);\n    if (!Array.isArray(parent.$__.populated[path].value)) {\n      continue;\n    }\n\n    parent.$__.populated[path].value = arr.map(val => val.$populated(remnant));\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}