{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.callback = void 0;\nconst fs = require(\"fs\");\nconst error_1 = require(\"../../../error\");\n/** Error for when the token is missing in the environment. */\nconst TOKEN_MISSING_ERROR = 'OIDC_TOKEN_FILE must be set in the environment.';\n/**\n * The callback function to be used in the automated callback workflow.\n * @param params - The OIDC callback parameters.\n * @returns The OIDC response.\n */\nconst callback = async () => {\n  const tokenFile = process.env.OIDC_TOKEN_FILE;\n  if (!tokenFile) {\n    throw new error_1.MongoAWSError(TOKEN_MISSING_ERROR);\n  }\n  const token = await fs.promises.readFile(tokenFile, 'utf8');\n  return {\n    accessToken: token\n  };\n};\nexports.callback = callback;","map":{"version":3,"names":["fs","require","error_1","TOKEN_MISSING_ERROR","callback","tokenFile","process","env","OIDC_TOKEN_FILE","MongoAWSError","token","promises","readFile","accessToken","exports"],"sources":["C:\\DEVC\\node_modules\\mongodb\\src\\cmap\\auth\\mongodb_oidc\\token_machine_workflow.ts"],"sourcesContent":["import * as fs from 'fs';\n\nimport { MongoAWSError } from '../../../error';\nimport type { OIDCCallbackFunction, OIDCResponse } from '../mongodb_oidc';\n\n/** Error for when the token is missing in the environment. */\nconst TOKEN_MISSING_ERROR = 'OIDC_TOKEN_FILE must be set in the environment.';\n\n/**\n * The callback function to be used in the automated callback workflow.\n * @param params - The OIDC callback parameters.\n * @returns The OIDC response.\n */\nexport const callback: OIDCCallbackFunction = async (): Promise<OIDCResponse> => {\n  const tokenFile = process.env.OIDC_TOKEN_FILE;\n  if (!tokenFile) {\n    throw new MongoAWSError(TOKEN_MISSING_ERROR);\n  }\n  const token = await fs.promises.readFile(tokenFile, 'utf8');\n  return { accessToken: token };\n};\n"],"mappings":";;;;;;AAAA,MAAAA,EAAA,GAAAC,OAAA;AAEA,MAAAC,OAAA,GAAAD,OAAA;AAGA;AACA,MAAME,mBAAmB,GAAG,iDAAiD;AAE7E;;;;;AAKO,MAAMC,QAAQ,GAAyB,MAAAA,CAAA,KAAkC;EAC9E,MAAMC,SAAS,GAAGC,OAAO,CAACC,GAAG,CAACC,eAAe;EAC7C,IAAI,CAACH,SAAS,EAAE;IACd,MAAM,IAAIH,OAAA,CAAAO,aAAa,CAACN,mBAAmB,CAAC;EAC9C;EACA,MAAMO,KAAK,GAAG,MAAMV,EAAE,CAACW,QAAQ,CAACC,QAAQ,CAACP,SAAS,EAAE,MAAM,CAAC;EAC3D,OAAO;IAAEQ,WAAW,EAAEH;EAAK,CAAE;AAC/B,CAAC;AAPYI,OAAA,CAAAV,QAAQ,GAAAA,QAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}