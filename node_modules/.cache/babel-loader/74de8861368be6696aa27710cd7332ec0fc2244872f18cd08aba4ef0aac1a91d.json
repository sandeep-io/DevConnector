{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RunCursorCommandOperation = exports.RunCommandOperation = void 0;\nconst responses_1 = require(\"../cmap/wire_protocol/responses\");\nconst operation_1 = require(\"../operations/operation\");\n/** @internal */\nclass RunCommandOperation extends operation_1.AbstractOperation {\n  constructor(namespace, command, options) {\n    super(options);\n    this.SERVER_COMMAND_RESPONSE_TYPE = responses_1.MongoDBResponse;\n    this.command = command;\n    this.options = options;\n    this.ns = namespace.withCollection('$cmd');\n  }\n  get commandName() {\n    return 'runCommand';\n  }\n  buildCommand(_connection, _session) {\n    return this.command;\n  }\n  buildOptions(timeoutContext) {\n    return {\n      ...this.options,\n      session: this.session,\n      timeoutContext,\n      signal: this.options.signal,\n      readPreference: this.options.readPreference\n    };\n  }\n}\nexports.RunCommandOperation = RunCommandOperation;\n/**\n * @internal\n *\n * A specialized subclass of RunCommandOperation for cursor-creating commands.\n */\nclass RunCursorCommandOperation extends RunCommandOperation {\n  constructor() {\n    super(...arguments);\n    this.SERVER_COMMAND_RESPONSE_TYPE = responses_1.CursorResponse;\n  }\n  handleOk(response) {\n    return response;\n  }\n}\nexports.RunCursorCommandOperation = RunCursorCommandOperation;","map":{"version":3,"names":["responses_1","require","operation_1","RunCommandOperation","AbstractOperation","constructor","namespace","command","options","SERVER_COMMAND_RESPONSE_TYPE","MongoDBResponse","ns","withCollection","commandName","buildCommand","_connection","_session","buildOptions","timeoutContext","session","signal","readPreference","exports","RunCursorCommandOperation","CursorResponse","handleOk","response"],"sources":["C:\\DEVC\\node_modules\\mongodb\\src\\operations\\run_command.ts"],"sourcesContent":["import { type Abortable } from '..';\nimport type { BSONSerializeOptions, Document } from '../bson';\nimport { type Connection } from '../cmap/connection';\nimport { CursorResponse, MongoDBResponse } from '../cmap/wire_protocol/responses';\nimport { AbstractOperation } from '../operations/operation';\nimport type { ReadPreferenceLike } from '../read_preference';\nimport type { ServerCommandOptions } from '../sdam/server';\nimport type { ClientSession } from '../sessions';\nimport { type TimeoutContext } from '../timeout';\nimport { type MongoDBNamespace } from '../utils';\n\n/** @public */\nexport type RunCommandOptions = {\n  /** Specify ClientSession for this command */\n  session?: ClientSession;\n  /** The read preference */\n  readPreference?: ReadPreferenceLike;\n  /**\n   * @experimental\n   * Specifies the time an operation will run until it throws a timeout error\n   */\n  timeoutMS?: number;\n  /** @internal */\n  omitMaxTimeMS?: boolean;\n\n  /**\n   * @internal Hints to `executeOperation` that this operation should not unpin on an ended transaction\n   * This is only used by the driver for transaction commands\n   */\n  bypassPinningCheck?: boolean;\n} & BSONSerializeOptions &\n  Abortable;\n\n/** @internal */\nexport class RunCommandOperation<T = Document> extends AbstractOperation<T> {\n  override SERVER_COMMAND_RESPONSE_TYPE = MongoDBResponse;\n  command: Document;\n  override options: RunCommandOptions;\n\n  constructor(namespace: MongoDBNamespace, command: Document, options: RunCommandOptions) {\n    super(options);\n    this.command = command;\n    this.options = options;\n    this.ns = namespace.withCollection('$cmd');\n  }\n\n  override get commandName() {\n    return 'runCommand' as const;\n  }\n\n  override buildCommand(_connection: Connection, _session?: ClientSession): Document {\n    return this.command;\n  }\n\n  override buildOptions(timeoutContext: TimeoutContext): ServerCommandOptions {\n    return {\n      ...this.options,\n      session: this.session,\n      timeoutContext,\n      signal: this.options.signal,\n      readPreference: this.options.readPreference\n    };\n  }\n}\n\n/**\n * @internal\n *\n * A specialized subclass of RunCommandOperation for cursor-creating commands.\n */\nexport class RunCursorCommandOperation extends RunCommandOperation {\n  override SERVER_COMMAND_RESPONSE_TYPE = CursorResponse;\n\n  override handleOk(\n    response: InstanceType<typeof this.SERVER_COMMAND_RESPONSE_TYPE>\n  ): CursorResponse {\n    return response;\n  }\n}\n"],"mappings":";;;;;;AAGA,MAAAA,WAAA,GAAAC,OAAA;AACA,MAAAC,WAAA,GAAAD,OAAA;AA6BA;AACA,MAAaE,mBAAkC,SAAQD,WAAA,CAAAE,iBAAoB;EAKzEC,YAAYC,SAA2B,EAAEC,OAAiB,EAAEC,OAA0B;IACpF,KAAK,CAACA,OAAO,CAAC;IALP,KAAAC,4BAA4B,GAAGT,WAAA,CAAAU,eAAe;IAMrD,IAAI,CAACH,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACC,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACG,EAAE,GAAGL,SAAS,CAACM,cAAc,CAAC,MAAM,CAAC;EAC5C;EAEA,IAAaC,WAAWA,CAAA;IACtB,OAAO,YAAqB;EAC9B;EAESC,YAAYA,CAACC,WAAuB,EAAEC,QAAwB;IACrE,OAAO,IAAI,CAACT,OAAO;EACrB;EAESU,YAAYA,CAACC,cAA8B;IAClD,OAAO;MACL,GAAG,IAAI,CAACV,OAAO;MACfW,OAAO,EAAE,IAAI,CAACA,OAAO;MACrBD,cAAc;MACdE,MAAM,EAAE,IAAI,CAACZ,OAAO,CAACY,MAAM;MAC3BC,cAAc,EAAE,IAAI,CAACb,OAAO,CAACa;KAC9B;EACH;;AA5BFC,OAAA,CAAAnB,mBAAA,GAAAA,mBAAA;AA+BA;;;;;AAKA,MAAaoB,yBAA0B,SAAQpB,mBAAmB;EAAlEE,YAAA;;IACW,KAAAI,4BAA4B,GAAGT,WAAA,CAAAwB,cAAc;EAOxD;EALWC,QAAQA,CACfC,QAAgE;IAEhE,OAAOA,QAAQ;EACjB;;AAPFJ,OAAA,CAAAC,yBAAA,GAAAA,yBAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}