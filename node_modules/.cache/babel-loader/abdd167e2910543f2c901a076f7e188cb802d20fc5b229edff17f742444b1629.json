{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RenameOperation = void 0;\nconst responses_1 = require(\"../cmap/wire_protocol/responses\");\nconst collection_1 = require(\"../collection\");\nconst utils_1 = require(\"../utils\");\nconst command_1 = require(\"./command\");\nconst operation_1 = require(\"./operation\");\n/** @internal */\nclass RenameOperation extends command_1.CommandOperation {\n  constructor(collection, newName, options) {\n    super(collection, options);\n    this.SERVER_COMMAND_RESPONSE_TYPE = responses_1.MongoDBResponse;\n    this.collection = collection;\n    this.newName = newName;\n    this.options = options;\n    this.ns = new utils_1.MongoDBNamespace('admin', '$cmd');\n  }\n  get commandName() {\n    return 'renameCollection';\n  }\n  buildCommandDocument(_connection, _session) {\n    const renameCollection = this.collection.namespace;\n    const to = this.collection.s.namespace.withCollection(this.newName).toString();\n    const dropTarget = typeof this.options.dropTarget === 'boolean' ? this.options.dropTarget : false;\n    return {\n      renameCollection,\n      to,\n      dropTarget\n    };\n  }\n  handleOk(_response) {\n    return new collection_1.Collection(this.collection.db, this.newName, this.collection.s.options);\n  }\n}\nexports.RenameOperation = RenameOperation;\n(0, operation_1.defineAspects)(RenameOperation, [operation_1.Aspect.WRITE_OPERATION]);","map":{"version":3,"names":["responses_1","require","collection_1","utils_1","command_1","operation_1","RenameOperation","CommandOperation","constructor","collection","newName","options","SERVER_COMMAND_RESPONSE_TYPE","MongoDBResponse","ns","MongoDBNamespace","commandName","buildCommandDocument","_connection","_session","renameCollection","namespace","to","s","withCollection","toString","dropTarget","handleOk","_response","Collection","db","exports","defineAspects","Aspect","WRITE_OPERATION"],"sources":["C:\\DEVC\\node_modules\\mongodb\\src\\operations\\rename.ts"],"sourcesContent":["import { type Connection } from '..';\nimport type { Document } from '../bson';\nimport { MongoDBResponse } from '../cmap/wire_protocol/responses';\nimport { Collection } from '../collection';\nimport type { ClientSession } from '../sessions';\nimport { MongoDBNamespace } from '../utils';\nimport { CommandOperation, type CommandOperationOptions } from './command';\nimport { Aspect, defineAspects } from './operation';\n\n/** @public */\nexport interface RenameOptions extends Omit<CommandOperationOptions, 'rawData'> {\n  /** Drop the target name collection if it previously exists. */\n  dropTarget?: boolean;\n  /** Unclear */\n  new_collection?: boolean;\n}\n\n/** @internal */\nexport class RenameOperation extends CommandOperation<Document> {\n  override SERVER_COMMAND_RESPONSE_TYPE = MongoDBResponse;\n  collection: Collection;\n  newName: string;\n  override options: RenameOptions;\n\n  constructor(collection: Collection, newName: string, options: RenameOptions) {\n    super(collection, options);\n    this.collection = collection;\n    this.newName = newName;\n    this.options = options;\n    this.ns = new MongoDBNamespace('admin', '$cmd');\n  }\n\n  override get commandName(): string {\n    return 'renameCollection' as const;\n  }\n\n  override buildCommandDocument(_connection: Connection, _session?: ClientSession): Document {\n    const renameCollection = this.collection.namespace;\n    const to = this.collection.s.namespace.withCollection(this.newName).toString();\n    const dropTarget =\n      typeof this.options.dropTarget === 'boolean' ? this.options.dropTarget : false;\n\n    return {\n      renameCollection,\n      to,\n      dropTarget\n    };\n  }\n\n  override handleOk(_response: InstanceType<typeof this.SERVER_COMMAND_RESPONSE_TYPE>): Document {\n    return new Collection(this.collection.db, this.newName, this.collection.s.options);\n  }\n}\n\ndefineAspects(RenameOperation, [Aspect.WRITE_OPERATION]);\n"],"mappings":";;;;;;AAEA,MAAAA,WAAA,GAAAC,OAAA;AACA,MAAAC,YAAA,GAAAD,OAAA;AAEA,MAAAE,OAAA,GAAAF,OAAA;AACA,MAAAG,SAAA,GAAAH,OAAA;AACA,MAAAI,WAAA,GAAAJ,OAAA;AAUA;AACA,MAAaK,eAAgB,SAAQF,SAAA,CAAAG,gBAA0B;EAM7DC,YAAYC,UAAsB,EAAEC,OAAe,EAAEC,OAAsB;IACzE,KAAK,CAACF,UAAU,EAAEE,OAAO,CAAC;IANnB,KAAAC,4BAA4B,GAAGZ,WAAA,CAAAa,eAAe;IAOrD,IAAI,CAACJ,UAAU,GAAGA,UAAU;IAC5B,IAAI,CAACC,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACC,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACG,EAAE,GAAG,IAAIX,OAAA,CAAAY,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC;EACjD;EAEA,IAAaC,WAAWA,CAAA;IACtB,OAAO,kBAA2B;EACpC;EAESC,oBAAoBA,CAACC,WAAuB,EAAEC,QAAwB;IAC7E,MAAMC,gBAAgB,GAAG,IAAI,CAACX,UAAU,CAACY,SAAS;IAClD,MAAMC,EAAE,GAAG,IAAI,CAACb,UAAU,CAACc,CAAC,CAACF,SAAS,CAACG,cAAc,CAAC,IAAI,CAACd,OAAO,CAAC,CAACe,QAAQ,EAAE;IAC9E,MAAMC,UAAU,GACd,OAAO,IAAI,CAACf,OAAO,CAACe,UAAU,KAAK,SAAS,GAAG,IAAI,CAACf,OAAO,CAACe,UAAU,GAAG,KAAK;IAEhF,OAAO;MACLN,gBAAgB;MAChBE,EAAE;MACFI;KACD;EACH;EAESC,QAAQA,CAACC,SAAiE;IACjF,OAAO,IAAI1B,YAAA,CAAA2B,UAAU,CAAC,IAAI,CAACpB,UAAU,CAACqB,EAAE,EAAE,IAAI,CAACpB,OAAO,EAAE,IAAI,CAACD,UAAU,CAACc,CAAC,CAACZ,OAAO,CAAC;EACpF;;AAjCFoB,OAAA,CAAAzB,eAAA,GAAAA,eAAA;AAoCA,IAAAD,WAAA,CAAA2B,aAAa,EAAC1B,eAAe,EAAE,CAACD,WAAA,CAAA4B,MAAM,CAACC,eAAe,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}