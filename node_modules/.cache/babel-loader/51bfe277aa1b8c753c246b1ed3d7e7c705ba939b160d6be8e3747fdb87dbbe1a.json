{"ast":null,"code":"'use strict';\n\nconst MongooseError = require('../../error/mongooseError');\nconst getDiscriminatorByValue = require('../../helpers/discriminator/getDiscriminatorByValue');\nconst applyTimestampsToChildren = require('../update/applyTimestampsToChildren');\nconst applyTimestampsToUpdate = require('../update/applyTimestampsToUpdate');\nconst cast = require('../../cast');\nconst castUpdate = require('../query/castUpdate');\nconst clone = require('../clone');\nconst decorateUpdateWithVersionKey = require('../update/decorateUpdateWithVersionKey');\nconst {\n  inspect\n} = require('util');\nconst setDefaultsOnInsert = require('../setDefaultsOnInsert');\n\n/**\n * Given a model and a bulkWrite op, return a thunk that handles casting and\n * validating the individual op.\n * @param {Model} originalModel\n * @param {Object} op\n * @param {Object} [options]\n * @api private\n */\n\nmodule.exports = function castBulkWrite(originalModel, op, options) {\n  const now = originalModel.base.now();\n  if (op['insertOne']) {\n    return callback => module.exports.castInsertOne(originalModel, op['insertOne'], options).then(() => callback(null), err => callback(err));\n  } else if (op['updateOne']) {\n    return callback => {\n      try {\n        module.exports.castUpdateOne(originalModel, op['updateOne'], options, now);\n        callback(null);\n      } catch (err) {\n        callback(err);\n      }\n    };\n  } else if (op['updateMany']) {\n    return callback => {\n      try {\n        module.exports.castUpdateMany(originalModel, op['updateMany'], options, now);\n        callback(null);\n      } catch (err) {\n        callback(err);\n      }\n    };\n  } else if (op['replaceOne']) {\n    return callback => {\n      module.exports.castReplaceOne(originalModel, op['replaceOne'], options).then(() => callback(null), err => callback(err));\n    };\n  } else if (op['deleteOne']) {\n    return callback => {\n      try {\n        module.exports.castDeleteOne(originalModel, op['deleteOne']);\n        callback(null);\n      } catch (err) {\n        callback(err);\n      }\n    };\n  } else if (op['deleteMany']) {\n    return callback => {\n      try {\n        module.exports.castDeleteMany(originalModel, op['deleteMany']);\n        callback(null);\n      } catch (err) {\n        callback(err);\n      }\n    };\n  } else {\n    return callback => {\n      const error = new MongooseError(`Invalid op passed to \\`bulkWrite()\\`: ${inspect(op)}`);\n      callback(error, null);\n    };\n  }\n};\nmodule.exports.castInsertOne = async function castInsertOne(originalModel, insertOne, options) {\n  const model = decideModelByObject(originalModel, insertOne['document']);\n  const doc = new model(insertOne['document']);\n  if (model.schema.options.timestamps && getTimestampsOpt(insertOne, options)) {\n    doc.initializeTimestamps();\n  }\n  if (options.session != null) {\n    doc.$session(options.session);\n  }\n  const versionKey = model?.schema?.options?.versionKey;\n  if (versionKey && doc[versionKey] == null) {\n    doc[versionKey] = 0;\n  }\n  insertOne['document'] = doc;\n  if (options.skipValidation || insertOne.skipValidation) {\n    return insertOne;\n  }\n  await insertOne['document'].$validate();\n  return insertOne;\n};\nmodule.exports.castUpdateOne = function castUpdateOne(originalModel, updateOne, options, now) {\n  if (!updateOne['filter']) {\n    throw new Error('Must provide a filter object.');\n  }\n  if (!updateOne['update']) {\n    throw new Error('Must provide an update object.');\n  }\n  const model = decideModelByObject(originalModel, updateOne['filter']);\n  const schema = model.schema;\n  const strict = options.strict ?? model.schema.options.strict;\n  const update = clone(updateOne['update']);\n  _addDiscriminatorToObject(schema, updateOne['filter']);\n  const doInitTimestamps = getTimestampsOpt(updateOne, options);\n  if (model.schema.$timestamps != null && doInitTimestamps) {\n    const createdAt = model.schema.$timestamps.createdAt;\n    const updatedAt = model.schema.$timestamps.updatedAt;\n    applyTimestampsToUpdate(now, createdAt, updatedAt, update, {\n      timestamps: updateOne.timestamps,\n      overwriteImmutable: updateOne.overwriteImmutable\n    });\n  }\n  if (doInitTimestamps) {\n    applyTimestampsToChildren(now, update, model.schema);\n  }\n  const globalSetDefaultsOnInsert = originalModel.base.options.setDefaultsOnInsert;\n  const shouldSetDefaultsOnInsert = updateOne.setDefaultsOnInsert ?? globalSetDefaultsOnInsert;\n  if (shouldSetDefaultsOnInsert !== false) {\n    setDefaultsOnInsert(updateOne['filter'], model.schema, update, {\n      setDefaultsOnInsert: true,\n      upsert: updateOne.upsert\n    });\n  }\n  decorateUpdateWithVersionKey(update, updateOne, model.schema.options.versionKey);\n  updateOne['filter'] = cast(model.schema, updateOne['filter'], {\n    strict: strict,\n    upsert: updateOne.upsert\n  });\n  updateOne['update'] = castUpdate(model.schema, update, {\n    strict: strict,\n    upsert: updateOne.upsert,\n    arrayFilters: updateOne.arrayFilters,\n    overwriteDiscriminatorKey: updateOne.overwriteDiscriminatorKey,\n    overwriteImmutable: updateOne.overwriteImmutable\n  }, model, updateOne['filter']);\n  return updateOne;\n};\nmodule.exports.castUpdateMany = function castUpdateMany(originalModel, updateMany, options, now) {\n  if (!updateMany['filter']) {\n    throw new Error('Must provide a filter object.');\n  }\n  if (!updateMany['update']) {\n    throw new Error('Must provide an update object.');\n  }\n  const model = decideModelByObject(originalModel, updateMany['filter']);\n  const schema = model.schema;\n  const strict = options.strict ?? model.schema.options.strict;\n  const globalSetDefaultsOnInsert = originalModel.base.options.setDefaultsOnInsert;\n  const shouldSetDefaultsOnInsert = updateMany.setDefaultsOnInsert ?? globalSetDefaultsOnInsert;\n  if (shouldSetDefaultsOnInsert !== false) {\n    setDefaultsOnInsert(updateMany['filter'], model.schema, updateMany['update'], {\n      setDefaultsOnInsert: true,\n      upsert: updateMany.upsert\n    });\n  }\n  const doInitTimestamps = getTimestampsOpt(updateMany, options);\n  if (model.schema.$timestamps != null && doInitTimestamps) {\n    const createdAt = model.schema.$timestamps.createdAt;\n    const updatedAt = model.schema.$timestamps.updatedAt;\n    applyTimestampsToUpdate(now, createdAt, updatedAt, updateMany['update'], {\n      timestamps: updateMany.timestamps,\n      overwriteImmutable: updateMany.overwriteImmutable\n    });\n  }\n  if (doInitTimestamps) {\n    applyTimestampsToChildren(now, updateMany['update'], model.schema);\n  }\n  _addDiscriminatorToObject(schema, updateMany['filter']);\n  decorateUpdateWithVersionKey(updateMany['update'], updateMany, model.schema.options.versionKey);\n  updateMany['filter'] = cast(model.schema, updateMany['filter'], {\n    strict: strict,\n    upsert: updateMany.upsert\n  });\n  updateMany['update'] = castUpdate(model.schema, updateMany['update'], {\n    strict: strict,\n    upsert: updateMany.upsert,\n    arrayFilters: updateMany.arrayFilters,\n    overwriteDiscriminatorKey: updateMany.overwriteDiscriminatorKey,\n    overwriteImmutable: updateMany.overwriteImmutable\n  }, model, updateMany['filter']);\n};\nmodule.exports.castReplaceOne = async function castReplaceOne(originalModel, replaceOne, options) {\n  const model = decideModelByObject(originalModel, replaceOne['filter']);\n  const schema = model.schema;\n  const strict = options.strict ?? model.schema.options.strict;\n  _addDiscriminatorToObject(schema, replaceOne['filter']);\n  replaceOne['filter'] = cast(model.schema, replaceOne['filter'], {\n    strict: strict,\n    upsert: replaceOne.upsert\n  });\n\n  // set `skipId`, otherwise we get \"_id field cannot be changed\"\n  const doc = new model(replaceOne['replacement'], strict, {\n    skipId: true\n  });\n  if (model.schema.options.timestamps && getTimestampsOpt(replaceOne, options)) {\n    doc.initializeTimestamps();\n  }\n  if (options.session != null) {\n    doc.$session(options.session);\n  }\n  const versionKey = model?.schema?.options?.versionKey;\n  if (versionKey && doc[versionKey] == null) {\n    doc[versionKey] = 0;\n  }\n  replaceOne['replacement'] = doc;\n  if (options.skipValidation || replaceOne.skipValidation) {\n    replaceOne['replacement'] = replaceOne['replacement'].toBSON();\n    return;\n  }\n  await replaceOne['replacement'].$validate();\n  replaceOne['replacement'] = replaceOne['replacement'].toBSON();\n};\nmodule.exports.castDeleteOne = function castDeleteOne(originalModel, deleteOne) {\n  const model = decideModelByObject(originalModel, deleteOne['filter']);\n  const schema = model.schema;\n  _addDiscriminatorToObject(schema, deleteOne['filter']);\n  deleteOne['filter'] = cast(model.schema, deleteOne['filter']);\n};\nmodule.exports.castDeleteMany = function castDeleteMany(originalModel, deleteMany) {\n  const model = decideModelByObject(originalModel, deleteMany['filter']);\n  const schema = model.schema;\n  _addDiscriminatorToObject(schema, deleteMany['filter']);\n  deleteMany['filter'] = cast(model.schema, deleteMany['filter']);\n};\nmodule.exports.cast = {\n  insertOne: module.exports.castInsertOne,\n  updateOne: module.exports.castUpdateOne,\n  updateMany: module.exports.castUpdateMany,\n  replaceOne: module.exports.castReplaceOne,\n  deleteOne: module.exports.castDeleteOne,\n  deleteMany: module.exports.castDeleteMany\n};\nfunction _addDiscriminatorToObject(schema, obj) {\n  if (schema == null) {\n    return;\n  }\n  if (schema.discriminatorMapping && !schema.discriminatorMapping.isRoot) {\n    obj[schema.discriminatorMapping.key] = schema.discriminatorMapping.value;\n  }\n}\n\n/**\n * gets discriminator model if discriminator key is present in object\n * @api private\n */\n\nfunction decideModelByObject(model, object) {\n  const discriminatorKey = model.schema.options.discriminatorKey;\n  if (object != null && Object.hasOwn(object, discriminatorKey)) {\n    model = getDiscriminatorByValue(model.discriminators, object[discriminatorKey]) || model;\n  }\n  return model;\n}\n\n/**\n * gets timestamps option for a given operation. If the option is set within an individual operation, use it. Otherwise, use the global timestamps option configured in the `bulkWrite` options. Overall default is `true`.\n * @api private\n */\n\nfunction getTimestampsOpt(opCommand, options) {\n  const opLevelOpt = opCommand.timestamps;\n  const bulkLevelOpt = options.timestamps;\n  if (opLevelOpt != null) {\n    return opLevelOpt;\n  } else if (bulkLevelOpt != null) {\n    return bulkLevelOpt;\n  }\n  return true;\n}","map":{"version":3,"names":["MongooseError","require","getDiscriminatorByValue","applyTimestampsToChildren","applyTimestampsToUpdate","cast","castUpdate","clone","decorateUpdateWithVersionKey","inspect","setDefaultsOnInsert","module","exports","castBulkWrite","originalModel","op","options","now","base","callback","castInsertOne","then","err","castUpdateOne","castUpdateMany","castReplaceOne","castDeleteOne","castDeleteMany","error","insertOne","model","decideModelByObject","doc","schema","timestamps","getTimestampsOpt","initializeTimestamps","session","$session","versionKey","skipValidation","$validate","updateOne","Error","strict","update","_addDiscriminatorToObject","doInitTimestamps","$timestamps","createdAt","updatedAt","overwriteImmutable","globalSetDefaultsOnInsert","shouldSetDefaultsOnInsert","upsert","arrayFilters","overwriteDiscriminatorKey","updateMany","replaceOne","skipId","toBSON","deleteOne","deleteMany","obj","discriminatorMapping","isRoot","key","value","object","discriminatorKey","Object","hasOwn","discriminators","opCommand","opLevelOpt","bulkLevelOpt"],"sources":["C:/DEVC/node_modules/mongoose/lib/helpers/model/castBulkWrite.js"],"sourcesContent":["'use strict';\n\nconst MongooseError = require('../../error/mongooseError');\nconst getDiscriminatorByValue = require('../../helpers/discriminator/getDiscriminatorByValue');\nconst applyTimestampsToChildren = require('../update/applyTimestampsToChildren');\nconst applyTimestampsToUpdate = require('../update/applyTimestampsToUpdate');\nconst cast = require('../../cast');\nconst castUpdate = require('../query/castUpdate');\nconst clone = require('../clone');\nconst decorateUpdateWithVersionKey = require('../update/decorateUpdateWithVersionKey');\nconst { inspect } = require('util');\nconst setDefaultsOnInsert = require('../setDefaultsOnInsert');\n\n/**\n * Given a model and a bulkWrite op, return a thunk that handles casting and\n * validating the individual op.\n * @param {Model} originalModel\n * @param {Object} op\n * @param {Object} [options]\n * @api private\n */\n\nmodule.exports = function castBulkWrite(originalModel, op, options) {\n  const now = originalModel.base.now();\n\n  if (op['insertOne']) {\n    return callback => module.exports.castInsertOne(originalModel, op['insertOne'], options).then(() => callback(null), err => callback(err));\n  } else if (op['updateOne']) {\n    return (callback) => {\n      try {\n        module.exports.castUpdateOne(originalModel, op['updateOne'], options, now);\n        callback(null);\n      } catch (err) {\n        callback(err);\n      }\n    };\n  } else if (op['updateMany']) {\n    return (callback) => {\n      try {\n        module.exports.castUpdateMany(originalModel, op['updateMany'], options, now);\n        callback(null);\n      } catch (err) {\n        callback(err);\n      }\n    };\n  } else if (op['replaceOne']) {\n    return (callback) => {\n      module.exports.castReplaceOne(originalModel, op['replaceOne'], options).then(() => callback(null), err => callback(err));\n    };\n  } else if (op['deleteOne']) {\n    return (callback) => {\n      try {\n        module.exports.castDeleteOne(originalModel, op['deleteOne']);\n        callback(null);\n      } catch (err) {\n        callback(err);\n      }\n    };\n  } else if (op['deleteMany']) {\n    return (callback) => {\n      try {\n        module.exports.castDeleteMany(originalModel, op['deleteMany']);\n        callback(null);\n      } catch (err) {\n        callback(err);\n      }\n    };\n  } else {\n    return (callback) => {\n      const error = new MongooseError(`Invalid op passed to \\`bulkWrite()\\`: ${inspect(op)}`);\n      callback(error, null);\n    };\n  }\n};\n\nmodule.exports.castInsertOne = async function castInsertOne(originalModel, insertOne, options) {\n  const model = decideModelByObject(originalModel, insertOne['document']);\n\n  const doc = new model(insertOne['document']);\n  if (model.schema.options.timestamps && getTimestampsOpt(insertOne, options)) {\n    doc.initializeTimestamps();\n  }\n  if (options.session != null) {\n    doc.$session(options.session);\n  }\n  const versionKey = model?.schema?.options?.versionKey;\n  if (versionKey && doc[versionKey] == null) {\n    doc[versionKey] = 0;\n  }\n  insertOne['document'] = doc;\n\n  if (options.skipValidation || insertOne.skipValidation) {\n    return insertOne;\n  }\n\n  await insertOne['document'].$validate();\n  return insertOne;\n};\n\nmodule.exports.castUpdateOne = function castUpdateOne(originalModel, updateOne, options, now) {\n  if (!updateOne['filter']) {\n    throw new Error('Must provide a filter object.');\n  }\n  if (!updateOne['update']) {\n    throw new Error('Must provide an update object.');\n  }\n\n  const model = decideModelByObject(originalModel, updateOne['filter']);\n  const schema = model.schema;\n  const strict = options.strict ?? model.schema.options.strict;\n\n  const update = clone(updateOne['update']);\n\n  _addDiscriminatorToObject(schema, updateOne['filter']);\n\n  const doInitTimestamps = getTimestampsOpt(updateOne, options);\n\n  if (model.schema.$timestamps != null && doInitTimestamps) {\n    const createdAt = model.schema.$timestamps.createdAt;\n    const updatedAt = model.schema.$timestamps.updatedAt;\n    applyTimestampsToUpdate(now, createdAt, updatedAt, update, {\n      timestamps: updateOne.timestamps,\n      overwriteImmutable: updateOne.overwriteImmutable\n    });\n  }\n\n  if (doInitTimestamps) {\n    applyTimestampsToChildren(now, update, model.schema);\n  }\n\n  const globalSetDefaultsOnInsert = originalModel.base.options.setDefaultsOnInsert;\n  const shouldSetDefaultsOnInsert = updateOne.setDefaultsOnInsert ?? globalSetDefaultsOnInsert;\n  if (shouldSetDefaultsOnInsert !== false) {\n    setDefaultsOnInsert(updateOne['filter'], model.schema, update, {\n      setDefaultsOnInsert: true,\n      upsert: updateOne.upsert\n    });\n  }\n\n  decorateUpdateWithVersionKey(\n    update,\n    updateOne,\n    model.schema.options.versionKey\n  );\n\n  updateOne['filter'] = cast(model.schema, updateOne['filter'], {\n    strict: strict,\n    upsert: updateOne.upsert\n  });\n  updateOne['update'] = castUpdate(model.schema, update, {\n    strict: strict,\n    upsert: updateOne.upsert,\n    arrayFilters: updateOne.arrayFilters,\n    overwriteDiscriminatorKey: updateOne.overwriteDiscriminatorKey,\n    overwriteImmutable: updateOne.overwriteImmutable\n  }, model, updateOne['filter']);\n\n  return updateOne;\n};\n\nmodule.exports.castUpdateMany = function castUpdateMany(originalModel, updateMany, options, now) {\n  if (!updateMany['filter']) {\n    throw new Error('Must provide a filter object.');\n  }\n  if (!updateMany['update']) {\n    throw new Error('Must provide an update object.');\n  }\n\n  const model = decideModelByObject(originalModel, updateMany['filter']);\n  const schema = model.schema;\n  const strict = options.strict ?? model.schema.options.strict;\n\n  const globalSetDefaultsOnInsert = originalModel.base.options.setDefaultsOnInsert;\n  const shouldSetDefaultsOnInsert = updateMany.setDefaultsOnInsert ?? globalSetDefaultsOnInsert;\n\n  if (shouldSetDefaultsOnInsert !== false) {\n    setDefaultsOnInsert(updateMany['filter'], model.schema, updateMany['update'], {\n      setDefaultsOnInsert: true,\n      upsert: updateMany.upsert\n    });\n  }\n\n  const doInitTimestamps = getTimestampsOpt(updateMany, options);\n\n  if (model.schema.$timestamps != null && doInitTimestamps) {\n    const createdAt = model.schema.$timestamps.createdAt;\n    const updatedAt = model.schema.$timestamps.updatedAt;\n    applyTimestampsToUpdate(now, createdAt, updatedAt, updateMany['update'], {\n      timestamps: updateMany.timestamps,\n      overwriteImmutable: updateMany.overwriteImmutable\n    });\n  }\n  if (doInitTimestamps) {\n    applyTimestampsToChildren(now, updateMany['update'], model.schema);\n  }\n\n  _addDiscriminatorToObject(schema, updateMany['filter']);\n\n  decorateUpdateWithVersionKey(\n    updateMany['update'],\n    updateMany,\n    model.schema.options.versionKey\n  );\n\n  updateMany['filter'] = cast(model.schema, updateMany['filter'], {\n    strict: strict,\n    upsert: updateMany.upsert\n  });\n\n  updateMany['update'] = castUpdate(model.schema, updateMany['update'], {\n    strict: strict,\n    upsert: updateMany.upsert,\n    arrayFilters: updateMany.arrayFilters,\n    overwriteDiscriminatorKey: updateMany.overwriteDiscriminatorKey,\n    overwriteImmutable: updateMany.overwriteImmutable\n  }, model, updateMany['filter']);\n};\n\nmodule.exports.castReplaceOne = async function castReplaceOne(originalModel, replaceOne, options) {\n  const model = decideModelByObject(originalModel, replaceOne['filter']);\n  const schema = model.schema;\n  const strict = options.strict ?? model.schema.options.strict;\n\n  _addDiscriminatorToObject(schema, replaceOne['filter']);\n  replaceOne['filter'] = cast(model.schema, replaceOne['filter'], {\n    strict: strict,\n    upsert: replaceOne.upsert\n  });\n\n  // set `skipId`, otherwise we get \"_id field cannot be changed\"\n  const doc = new model(replaceOne['replacement'], strict, { skipId: true });\n  if (model.schema.options.timestamps && getTimestampsOpt(replaceOne, options)) {\n    doc.initializeTimestamps();\n  }\n  if (options.session != null) {\n    doc.$session(options.session);\n  }\n  const versionKey = model?.schema?.options?.versionKey;\n  if (versionKey && doc[versionKey] == null) {\n    doc[versionKey] = 0;\n  }\n  replaceOne['replacement'] = doc;\n\n  if (options.skipValidation || replaceOne.skipValidation) {\n    replaceOne['replacement'] = replaceOne['replacement'].toBSON();\n    return;\n  }\n\n  await replaceOne['replacement'].$validate();\n  replaceOne['replacement'] = replaceOne['replacement'].toBSON();\n};\n\nmodule.exports.castDeleteOne = function castDeleteOne(originalModel, deleteOne) {\n  const model = decideModelByObject(originalModel, deleteOne['filter']);\n  const schema = model.schema;\n\n  _addDiscriminatorToObject(schema, deleteOne['filter']);\n\n  deleteOne['filter'] = cast(model.schema, deleteOne['filter']);\n};\n\nmodule.exports.castDeleteMany = function castDeleteMany(originalModel, deleteMany) {\n  const model = decideModelByObject(originalModel, deleteMany['filter']);\n  const schema = model.schema;\n\n  _addDiscriminatorToObject(schema, deleteMany['filter']);\n\n  deleteMany['filter'] = cast(model.schema, deleteMany['filter']);\n};\n\nmodule.exports.cast = {\n  insertOne: module.exports.castInsertOne,\n  updateOne: module.exports.castUpdateOne,\n  updateMany: module.exports.castUpdateMany,\n  replaceOne: module.exports.castReplaceOne,\n  deleteOne: module.exports.castDeleteOne,\n  deleteMany: module.exports.castDeleteMany\n};\n\nfunction _addDiscriminatorToObject(schema, obj) {\n  if (schema == null) {\n    return;\n  }\n  if (schema.discriminatorMapping && !schema.discriminatorMapping.isRoot) {\n    obj[schema.discriminatorMapping.key] = schema.discriminatorMapping.value;\n  }\n}\n\n/**\n * gets discriminator model if discriminator key is present in object\n * @api private\n */\n\nfunction decideModelByObject(model, object) {\n  const discriminatorKey = model.schema.options.discriminatorKey;\n  if (object != null && Object.hasOwn(object, discriminatorKey)) {\n    model = getDiscriminatorByValue(model.discriminators, object[discriminatorKey]) || model;\n  }\n  return model;\n}\n\n/**\n * gets timestamps option for a given operation. If the option is set within an individual operation, use it. Otherwise, use the global timestamps option configured in the `bulkWrite` options. Overall default is `true`.\n * @api private\n */\n\nfunction getTimestampsOpt(opCommand, options) {\n  const opLevelOpt = opCommand.timestamps;\n  const bulkLevelOpt = options.timestamps;\n  if (opLevelOpt != null) {\n    return opLevelOpt;\n  } else if (bulkLevelOpt != null) {\n    return bulkLevelOpt;\n  }\n  return true;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}